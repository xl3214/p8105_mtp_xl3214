---
title: "p8105_midterm_xl3214"
author: "Xuan Lu"
date: "2023-10-19"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r library necessary R packages, message = FALSE, echo = FALSE}
library(dplyr)
library(tidyr)
```

## Raw Data Overview and Report Goal

```{r Import data, message = FALSE, echo = FALSE, results = 'hide'}
coa <- readxl::read_excel("USPS\ CHANGE\ OF\ ADDRESS\ NYC.xlsx")
zip <- read.csv("Zip Codes.csv")
summary(coa)
summary(zip)
```

The raw USPS Change of Address NYC dataset has `r ncol(coa)` variables and `r nrow(coa)` observations. The raw Zip Codes dataset has `r ncol(zip)` variables and `r nrow(zip)` observations.


```{r Clean and Tidy and Combine the Datasets}
coa <- readxl::read_excel("USPS\ CHANGE\ OF\ ADDRESS\ NYC.xlsx") |>
  janitor::clean_names() |>
  rename(zip_code = zipcode) |>
  mutate(year = lubridate::year(month)) |>
  mutate(net_change = total_perm_in - total_perm_out) 
# pivot_wider(names_from = month, values_from = c(net_change, total_perm_in, total_perm_out))
zip <- read.csv("Zip Codes.csv") |> 
  janitor::clean_names() |> 
  mutate(borough = county_name) |>
  filter(!(zip_code == 10463 & county_name == "New York"))
tidy <- merge(coa, zip, by = "zip_code", all.x = TRUE)


summary(tidy)
```


Import, tidy, combine, and otherwise clean the data. In the ZIP code data, create a borough variable using county names. Resolve any issues that arise when merging COA and ZIP code data. Restrict your dataset to only variables necessary for later parts of this report. Describe the major steps in the data wrangling process in words, including what steps you took to address data quality issues.
